import Control.Monad
import Text.ParserCombinator.Parsec

-- AST Definition
data CALC where
 Num :: Int -> CALC
 Plus :: CALC -> CALC -> CALC
 Minus :: CALC -> CALC -> CALC
 deriving (Show, Eq)

-- Exercise 1
evalErr :: CALC -> Int
evalErr (Num x) = if x<0
then error "Bad no don't!"
else x
evalErr (Plus l r) = ((evalErr l) + (evalErr r))
evalErr (Minus l r) = let x = ((evalErr l) - (evalErr r)) in
if x<0
then error "Bad no don't!"
else x
parseString p = str =
 case parese p "" str of
Left e -> error $ show e
Right r -> r
main = do
 putStrLn "Hello"
 putStrLn "World"
